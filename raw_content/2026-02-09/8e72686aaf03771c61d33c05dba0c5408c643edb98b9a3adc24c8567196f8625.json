{
  "title": "forecourt networking",
  "link": "https://computer.rip/2026-02-08-forecourt-networking.html",
  "published": "08 Feb 2026 00:00:00 UT",
  "summary": "<p>The way I see it, few parts of American life are as quintessentially American\nas buying gas. We love our cars, we love our oil, and an industry about as old\nas automobiles themselves has developed a highly consistent, fully automated,\nand fairly user friendly system for filling the former with the latter.</p>\n<p>I grew up in Oregon. While these rules have since been relaxed, many know\nOregon for its long identity as one of two states where you cannot pump\nyour own gas (the other being New Jersey). Instead, an attendant, employee\nof the gas station, operates the equipment. Like Portland's lingering <em>indoor</em>\ngas station, Oregon's favor for &quot;full-service&quot; is a holdover. It makes sense,\nof course, that all gas stations used to be full-service.</p>\n<p>The front part of a gas station, where the pumps are and where you pull up your\ncar, is called the <em>Forecourt.</em> The practicalities of selling gasoline, namely\nthat it is a liquid sold by volume, make the forecourt more complex than you\nmight realize. It's a set of devices that many of us interact with on a regular\nbasis, but we rarely think about the sheer number of moving parts and\nlong-running need for digital communications. Hey, that latter part sounds\ninteresting, doesn't it?</p>\n<p>Electric vehicles are catching on in the US. My personal taste in vehicles\ntends towards &quot;old&quot; and &quot;cheap,&quot; but EVs have been on the market for long\nenough that they now come in that variety. Since my daily driver is an EV,\nI don't pay my dues at the Circle K nearly as often as I used to. One\nof the odd little details of EVs is the complexity hidden in the charging\nsystem or &quot;EVSE,&quot; which requires digital communications with the vehicle\nfor protection reasons. As consumers across the country install EVSE in\ntheir garages, we're all getting more familiar with these devices and their\nprice tags. We might forget that, well, handling a fluid takes a lot of\nequipment as well... we just don't think about it, having shifted the whole\nproblem to a large industry of loosely supervised hazardous chemical\nhandling facilities.</p>\n<p>Well, I don't mean to turn this into yet another discussion of the significant\nenvironmental hazard posed by leaking underground storage tanks. Instead, we're\ngoing to talk about forecourt technology. Let's start, then, with a rough,\nsketchy history of the forecourt.</p>\n<p><img alt=\"Illustration from Triangle MicroSystems manual\" src=\"https://computer.rip/f/gas/1.png\" /></p>\n<p>The earliest volumetric fuel dispensers used an elevated glass tank where\nfuel was staged and measured before gravity drained it through the hose\ninto the vehicle tank. Operation of these pumps was very manual, with an\nattendant filling the calibrated cylinder with the desired amount of gas,\nemptying it into the vehicle, and then collecting an appropriate sum of money.\nAs an upside, the customer could be quite confident of the amount of fuel they\npurchased, since they could see it temporarily stored in the cylinder.</p>\n<p>As cars proliferated in the 1910s, a company called Gilbarco developed a fuel\ndispenser that actually measured the quantity of fuel as it was being pumped\nfrom storage tank to vehicle... with no intermediary step in a glass cylinder\nrequired. The original Gilbarco design involved a metal turbine in a small\nglass sphere; the passing fuel spun the turbine which drove a mechanical\ncounter. In truth, the design of modern fuel dispensers hasn't changed that\nmuch, although the modern volumetric turbines are made more accurate with a\npositive displacement design similar to a Roots blower.</p>\n<p>Even with the new equipment, fuel was sold in much the same way: an attendant\noperated the pump, read the meter, and collected payment. There was,\nadmittedly, an increased hazard of inattentive or malicious gas stations\novercharging.  Volumetric dispensers thus lead to dispensers that automatically\ncalculated the price (now generally a legal requirement) and the practice of a\nregulatory authority like the state or tribal government testing fuel\ndispensers for calibration. Well, if consumers were expected to trust the gas\nstation, perhaps the gas station ought to trust the consumer... and these same\nimprovements to fuel dispensers made it more practical for the motorist to\nsimply pump their own gas.</p>\n<p>At the genesis of self-serve gasoline, most stations operated on a postpayment\nmodel. You pulled up, pumped gas, and then went inside to the attendant to pay\nwhatever you owed. Of course, a few unscrupulous people would omit that last\nstep. A simple countermeasure spread in busy cities: the pumps were normally\nkept powered off. Before dispensing gasoline, you would have to speak with\nthe attendant. Depending on how trustworthy they estimated you to be, they\nmight just turn on power to the pump or they might require you to deposit some\ncash with them in advance. This came to be known as &quot;prepayment,&quot; and is now so\nuniversal in th US that the &quot;prepay only&quot; stickers on fuel dispensers seem a\nbit anachronistic <sup class=\"footnote-ref\" id=\"fnref-1\"><a href=\"#fn-1\">1</a></sup>.</p>\n<p>It's simple enough to imagine how this scheme worked, electronically. There is\nseparate power wiring to the pumps for each dispenser (and these stations\nusually only had two dispensers anyway), and that wiring runs to the counter\nwhere the attendant can directly switch power. Most gas stations do use\nsubmersible pumps in the tank rather than in the actual dispenser, but older\ndesigns still had one pump per dispenser and were less likely to use\nsubmersible pumps anyway.</p>\n<p>Soon, things became more complex. Modern vehicles have big gas tanks, and gas\nhas become fairly expensive. What happens when a person deposits, say, $20 of\n&quot;earnest cash&quot; to get a pump turned on, and then pumps $25 worth of gas?\nHopefully they have the extra $5, but the attendant doesn't know that. Besides,\ngas stations grew larger and it wasn't always feasible for the attendant to see\nthe dispenser counters out the window. You wouldn't want to encourage people\nto just lie about the amount of gas they'd dispensed.</p>\n<p>Gas stations gained remote control: using digital communications, fuel\ndispensers reported the value of their accumulators to a controller at the\ncounter. The attendant would use the same controller to enable dispenser,\npotentially setting a limit at which the dispenser would automatically shut\noff. If you deposit $20, they enable the pump with a limit of $20. If you\npay by card, they will likely authorize the card for a fixed amount (this\nused to routinely be $40 but has gone up for reasons you can imagine),\nenable the dispenser with no limit or a high limit, and then capture the actual\namount after you finished dispensing <sup class=\"footnote-ref\" id=\"fnref-2\"><a href=\"#fn-2\">2</a></sup>.</p>\n<p>And that's how gas stations worked for quite a few decades. Most gas stations\nthat you use today still have this exact same system in operation, but it may\nhave become buried under additional layers of automation. There are two things\nthat have caused combinatorial complexity in modern forecourt control: first,\nany time you automate something, there is a natural desire to automate <em>more</em>\nthings. With a digital communications system between the counter and the\nforecourt, you can do more than just enable the dispensers! You might want to\nmonitor the levels in the tanks, update the price on the big sign, and sell\ncar wash vouchers with a discount for a related fuel purchase. All of these\ncapabilities, and many more, have been layered on to forecourt control systems\nthrough everything from serial bus accessories to REST API third party\nintegrations.</p>\n<p>Speaking of leaking underground storage tanks, you likely even have a\nregulatory obligation to monitor tank levels and ensure they balance against\nbulk fuel deliveries and dispenser totals. This detects leakage, but it also\ndetects theft, still a surprisingly common problem for gas stations. Your\ncorporate office, or your bulk fuel provider, may monitor these parameters\nremotely to schedule deliveries and make sure that theft isn't happening with\nthe cooperation of the station manager. Oh, and prices, those may be set\ncentrally as well.</p>\n<p>The second big change is nearly universal &quot;CRIND.&quot; This is an awkward industry\nacronym for everyone's favorite convenience feature, Card Reader IN Dispenser.\nCRIND fuel dispensers let payment card customers complete the whole authorize,\ndispense, and capture process right at the dispenser, without coming inside at\nall. CRIND is so common today that it's almost completely displaced even its\nimmediate ancestor, &quot;fuel island&quot; outdoor payment terminals (OPTs) that provide\na central kiosk where customers make payments for multiple dispensers. This\nused to be a pretty common setup in California where self-service caught on\nearly but, based on my recent travels, has mostly evaporated there.</p>\n<p>So you can see that we have a complicated and open-ended set of requirements\nfor communication and automation in the fuel court: enabling and monitoring\npumps, collecting card payments, and monitoring and controlling numerous\naccessories. Most states also require gas stations to have an intercom system\nso that customers can request help from the attendant inside. Third-party\nloyalty systems were briefly popular although, mercifully, the more annoying of\nthem have mostly died out... although only because irritating\nadvertising-and-loyalty technology has been better integrated into the\ndispensers themselves.</p>\n<p>Further complicating things, gas station forecourts are the epitome of legacy\nintegration. Fuel dispensers are expensive, concrete slabs are expensive, and\ngas stations run on thin margins. While there aren't very many manufacturers\nof fuel dispensers, or multi-product dispensers as they're typically called\ntoday, the industry of accessories, control systems, and replacement parts\nis vast. Most gas stations have accumulated several different generations of\ncontrol systems and in-dispenser accessories like tree rings. New features\nlike CRIND, chip payment, touchless payment, and &quot;Gas Station TV&quot; have each\nmotivated another round of new communications protocols.</p>\n<p>And that's how we get to our modern world, where the brochure for a typical\ngas station forecourt controller lists 25+ different communications\nprotocols—and assures that you can use &quot;any mix.&quot;</p>\n<p>Variability between gas stations increases when you consider the differing\nlevels of automation available. It used to be common for gas stations to use\nstandalone pump controllers that didn't integrate with much else—when you\nprepaid, for example, the cashier would manually enter the pump number and\nprepayment limit on a separate device from the cash register.</p>\n<p>Here in New Mexico, quite a few stations used to use the Triangle MicroSystems\nMPC family, a wedge-shaped box with an industrial-chic membrane keypad in\ngrey and bright red. Operation of the MPC is pretty simple, basically\npressing a pump number and then entering a dollar limit. Of course, the full\nset of features runs much deeper, including financial reporting and fleet\nfueling contracts.</p>\n<p>This is another important dimension of the gas station control industry: fleet\nfueling. It used to be that gas stations were divided into two categories,\nconsumer stations that took cash payment and &quot;cardlock&quot; stations that used an\nelectronic payment system. Since cardlock stations originally relied on\nproprietary, closed payment agreements, they didn't sell to consumers and had\ndifferent control requirements (often involving an outside payment terminal).\nAs consumers widely adopted card payments, the lines between the two markets\nblurred. Modern cardlock fueling networks, like CFN and Wex, are largely just\nanother set of payment processors. Most major gas stations participate in most\nmajor cardlock networks, just the same as they participate in most major ATM\nnetworks for lower-cost processing of debit cards.</p>\n<p>Of course, more payment networks call for more integrations. The complexity\nof the modern payment situation has generally outgrown standalone controllers,\nand they seem to be fading away. Instead, the typical gas station today has\nforecourt control completely integrated into their POS system. Forecourt\nintegration is such an important requirement that gas station convenience\nstores, mostly handling normal grocery-type transactions, nevertheless\nrely almost exclusively on dedicated gas station POS solutions. In other\nwords, next time you buy a can of Monster and a bag of chips, the cashier\nmost likely rings you up and takes payment through a POS solution offered\nby the dispenser manufacturer (like Gilbarco Passport Retail) or one of\ndozens of vendors that caters specifically to gas stations (including\ncompelling names like Petrosoft). Control of fuel dispensers is just too\nweird of a detail to integrate into other POS platforms... or so it was\nthought, although things clearly get odd as Gilbarco has to implement basic\n<a href=\"https://computer.rip/2021-02-27-kitchen-videos.html\">kitchen video system</a>\nintegration for the modern truck stop.</p>\n<p>So how does this all work technically? That's the real topic of fascination,\nright? Well, it's a mess and hard to describe succinctly. There are so many\ndifferent options, and particularly legacy retrofit options, that one gas\nstation will be very different from the next.</p>\n<p>In the days of &quot;mechanical pumps,&quot; simple designs with mechanical counters,\ncontrol wiring was simple: the dispenser (really a mechanical device called a\npulser) was expected to provide &quot;one pulse per penny&quot; on a counting circuit\nfor dollars dispensed, which incremented a synchronized counter on the\ncontroller. For control the other way, the controller just closed relays to\nopen &quot;fast&quot; or &quot;slow&quot; valves on the dispenser. The controller might also get a\nsignal when a handle lever is activated, to alert the attendant that someone\nis trying to use a dispenser, but that was about it.</p>\n<p>Later on, particularly as multi-product dispensers with two hoses and four\nrates (due to diesel and three grades) became common, wiring all the different\npulse and valve circuits became frustrating. Besides, pumps with digital\ncounters no longer needed mechanical adjustment when prices changed, allowing\nfor completely centralized price calculation. To simplify wiring while enabling\nnew features, fuel dispenser manufacturers introduced simple current-loop\nserial buses. These are usually implemented as a single loop that passes\nthrough each dispenser, carrying small packets with addressed commands or\nreports, usually at a pretty low speed. The dispensers designed for use with\nthese systems are much more standalone than the older mechanical dispensers,\nand perform price accumulation internally, so they only needed to report\nperiodic totals during fueling and at the end of the transaction.</p>\n<p>An upside of these more standalone dispensers is that they made CRIND easier to\nimplement: the payment terminal in the dispenser could locally enable the pump,\nincluding setting limits, by a direct interface to the pump controller. Still,\nthe CRIND needed some way to actually authorize and report transactions.\nSolution: another current loop. Most CRIND installations involved a second,\nsimilar, but usually higher-speed serial bus that specifically handled\npayment processing. The CRIND terminals in such a system usually communicated\nwith a back-office payment server using a very simple protocol, sending card\ninformation in the clear. That back-office server might be in the back of the\nconvenience store, but it could also be remote.</p>\n<p>As gas stations introduced CRIND, plastic card sales became a key part of the\nbusiness. Card volume is much greater than cash volume at most stations, and\nit's known that customers will often leave rather than go inside if there\nis a problem with CRIND payment. So gas stations prioritized reliability of\npayments. To this day, if you look at the roof of many gas stations, you'll\nfind a small parabolic antenna pointed aimlessly skywards. By the end of the\n1990s, many chain gas stations used satellite networks for payment processing,\neither routinely (cheaper than a leased telephone line!) or as a contingency.\nCisco's VSAT terminal modules for edge routers, combined with a boutique\nindustry of Mbps-class data networks on leased transponders, made satellite\na fairly inexpensive and easy-to-obtain option for handling small payment\nprocessing messages.</p>\n<p>This arrangement of one current loop for dispenser control and one current loop\nfor payment terminals lasted for long enough that it became a de facto wiring\nstandard for the gas station forecourt. New construction gas stations provided\nconduits from the convenience store to the pumps, and those conduits were\nusually spec'd for an A/C power circuit (controlled, per code, by an emergency\nstop button) and two low-voltage data circuits. The low-voltage data circuits\nwere particularly important because the electrical code and fire code impose\nspecific rules on electrical systems used in proximity to flammable\nfluids—what's called a &quot;hazardous environment&quot; in the language of safety codes.\nDispenser manufacturers sold specialized field interconnection enclosures that\nisolated the data circuits to the required safety standard, lowering the\ncomplexity of the installation in the dispensers themselves <sup class=\"footnote-ref\" id=\"fnref-3\"><a href=\"#fn-3\">3</a></sup>.</p>\n<p><img alt=\"Illustration from Gilbarco manual\" src=\"https://computer.rip/f/gas/2.png\" /></p>\n<p>The next event to challenge forecourt infrastructure was the introduction of\nEMV chip and tap-to-pay payment cards. Many Americans will remember how fuel\ndispensers routinely had tap-to-pay terminals physically installed for years,\neven a decade, before they actually started working. Modernizing dispensers\nusually meant installing a new CRIND system with EMV support, but upgrades\nto the underlying network to support them took much longer. The problem was\nexactly the simplicity of the CRIND current loop design: EMV standards\nrequired that all data be encrypted (you couldn't just send card numbers to\nthe backend in the clear as older systems did), and required larger and\nmore numerous messages between the payment network, the terminal, and the\ncard itself. Even if supporting EMV transactions on the serial bus was\npossible, most manufacturers chose not to, opting for the vastly simpler\ndesign of direct IP connectivity to each CRIND terminal.</p>\n<p>But how do you put IP over a simple two-wire serial bus? Well, there are a\nlot of options, and the fuel dispenser industry chose basically all of them.\nThere were proprietary solutions, but more common were IP networking\ntechnologies adapted to the forecourt application. Consider DSL: for a good\ndecade, many forecourt interconnection boxes and fuel dispenser controllers\nsupported good old fashioned DSL over the payment loop (not to be confused\nwith DSL as in Diesel, an abbreviation also used in the fuel industry).</p>\n<p>Bandwidth requirements increased yet further, though, with the introduction\nof Maria Menounos. &quot;Forecourt media&quot; advertising systems can deliver full\nvideo to each dispenser, a golden opportunity to pitch credit cards and\nmonetize something called &quot;Cheddar.&quot; While there was a long era of satellite\ntransponders delivering analog video to chains for in-store marketing (I\nwill one day write about WalMart TV), the &quot;GSTV&quot; phenomenon is newer and\ncompletely internet-based. For HD video you need a little better than the\n5Mbps performance that industrial DSL systems were delivering. Enter\n<a href=\"https://computer.rip/2025-02-02-residential-networking-over-telephone.html\">HomePlug</a>.</p>\n<div class=\"beg\">\n<hr />\n<p>I put a lot of time into writing this, and I hope that you enjoy reading\nit. If you can spare a few dollars, consider <a href=\"https://ko-fi.com/jbcrawford\">supporting me on\nko-fi</a>. You'll receive an occasional extra,\nsubscribers-only post, and defray the costs of providing artisanal, hand-built\nworld wide web directly from Albuquerque, New Mexico.</p>\n<hr />\n</div>\n<p>Despite HomePlug's limited market success, it has been widely adopted in\ngas station forecourts. The advantage of HomePlug is clear: it dispenses with\nthe control wiring loops entirely, providing IP communications with dispensers\nover the electrical supply wiring. It usually presents an almost zero-wiring\nupgrade, just adding HomePlug boards on both ends, so even in stations with\ngood forecourt serial loops, dispenser upgrades often end in a switch to\nHomePlug.</p>\n<p>The most interesting thing about these networks is just how modular it all\nstill is: somewhere in your local gas station, there is a forecourt controller.\nDepending on the age of the system, that might be a bespoke embedded system\nwith plug-in modules, or it might be a generic N100 Mini PC with a few serial\nports and mostly IP connectivity. There is likely a forecourt interconnection\nbox that holds not just the wiring terminals but also adapter boards that\nconvert between various serial protocols, IP carriers, and control signals.\nThe point of sale backend server might interact with the forecourt controller\nvia IP, but older systems used RS-232... and systems in between might use\nthe same logical protocol as they did with RS-232, but encapsulated in TCP.\nThe installation manuals for all of these products include pages of wiring\ndiagrams for each different scenario.</p>\n<p>Next time you stop at a gas station and find the CRIND not working, think\nabout all of that: whatever technician comes out to fix it will have their\nwork cut out for them, just to figure out which way that gas station is\nset up.</p>\n<div class=\"footnotes\">\n<ol>\n<li id=\"fn-1\">\n<p>In more rural areas of poorer states such as my own, you will still\nfind gas stations where the attendant turns the pump on after eyeing you.\nThese are mostly stations that just haven't had the money to install newer\nequipment, which as we will see can be a big project. I have lived here for\nabout a decade, long enough to have noticed a significant decline in the\nnumber of these stations still operating.<a class=\"footnote\" href=\"#fnref-1\">&#8617;</a></p></li>\n<li id=\"fn-2\">\n<p>For most payment card technologies, &quot;authorizing&quot; and &quot;capturing&quot; are separate\nsteps that can be done with different dollar amounts. This model of paying for\ngas is one of the reasons why.<a class=\"footnote\" href=\"#fnref-2\">&#8617;</a></p></li>\n<li id=\"fn-3\">\n<p>For example, UL standards require physical separation between mains\nvoltage wiring and plumbing components inside of fuel dispenser enclosures.\nThe enclosures are actually rather crowded spaces, so that can turn into a\nreal hassle—and a selling point for low-voltage-only control systems. Fuel\ndispenser enclosures are also required to contain a fuel fire due to leaking\nplumbing, which is why you see fairly heavy sheet metal construction with\nthe sides forming chimney-like vents.<a class=\"footnote\" href=\"#fnref-3\">&#8617;</a></p></li>\n</ol>\n</div>",
  "id": "https://computer.rip/2026-02-08-forecourt-networking.html"
}