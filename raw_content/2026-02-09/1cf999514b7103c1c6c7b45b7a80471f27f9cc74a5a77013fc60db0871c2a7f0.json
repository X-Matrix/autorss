{
  "title": "Self-hosting my photos with Immich",
  "link": "https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/",
  "published": "2025-11-29T08:22:05+01:00",
  "summary": "<p>For every cloud service I use, I want to have a local copy of my data for backup\npurposes and independence. Unfortunately, the <code>gphotos-sync</code> tool <a href=\"https://github.com/gilesknap/gphotos-sync-discussion/discussions/1\">stopped\nworking in March\n2025</a> when\nGoogle restricted the OAuth scopes, so I needed an alternative for my existing\nGoogle Photos setup. In this post, I describe how I have set up\n<a href=\"https://immich.app/\">Immich</a>, a self-hostable photo manager.</p>\n<p>Here is the end result: a few (live) photos from <a href=\"/posts/2025-09-21-nixcon-2025-trip-report/\">NixCon\n2025</a>:</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<a href=\"https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/2025-11-19-immich-screenshot-featured.jpg\"><img alt=\"screenshot of Immich in a web browser\" height=\"504\" src=\"https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/2025-11-19-immich-screenshot-featured_hu_744c6f048556917c.jpg\" style=\"border: 1px solid #000;\" title=\"screenshot of Immich in a web browser\" width=\"600\" /></a>\n\n\n\n<h2 id=\"step-1-hardware\">Step 1. Hardware</h2>\n<p>I am running Immich on my <a href=\"/posts/2024-07-02-ryzen-7-mini-pc-low-power-proxmox-hypervisor/\">Ryzen 7 Mini PC (ASRock DeskMini\nX600)</a>, which\nconsumes less than 10 W of power in idle and has plenty of resources for VMs (64\nGB RAM, 1 TB disk). You can read more about it in my blog post from July 2024:</p>\n\n\n\n  <div class=\"postlink\">\n      <div>\n\t<a href=\"https://michael.stapelberg.ch/posts/2024-07-02-ryzen-7-mini-pc-low-power-proxmox-hypervisor/\"><h3>Ryzen 7 Mini-PC makes a power-efficient VM host</h3></a>\n      </div>\n      <div class=\"summary\">\n\t\n\t\n\t\n\t\n\t\n\t<a href=\"https://michael.stapelberg.ch/posts/2024-07-02-ryzen-7-mini-pc-low-power-proxmox-hypervisor/\"><img height=\"134\" src=\"https://michael.stapelberg.ch/posts/2024-07-02-ryzen-7-mini-pc-low-power-proxmox-hypervisor/240630-server-featured_hu_6c2736729d115f81.jpg\" width=\"200\" /></a>\n\t\n\t<p>\n\t  <a href=\"https://michael.stapelberg.ch/posts/2024-07-02-ryzen-7-mini-pc-low-power-proxmox-hypervisor/\">\n\t  When I saw the first reviews of the ASRock DeskMini X600 barebone, I was immediately interested in building a home-lab hypervisor (VM host) with it. Apparently, the DeskMini X600 uses less than 10W of power but supports latest-generation AMD CPUs like the Ryzen 7 8700G!\n\n\t  <span class=\"readmore\"><a href=\"https://michael.stapelberg.ch/posts/2024-07-02-ryzen-7-mini-pc-low-power-proxmox-hypervisor/\">Read more →</a></span>\n\t  </a>\n\t</p>\n      </div>\n  </div>\n\n\n<p>I installed <a href=\"https://proxmox.com/en/\">Proxmox</a>, an Open Source virtualization\nplatform, to divide this mini server into VMs, but you could of course also\ninstall Immich directly on any server.</p>\n<h2 id=\"step-2-install-immich\">Step 2. Install Immich</h2>\n<p>I created a VM (named “photos”) with 500 GB of disk space, 4 CPU cores and 4 GB of RAM.</p>\n<p>For the initial import, you could assign more CPU and RAM, but for normal usage, that’s enough.</p>\n<p>I <a href=\"/posts/2025-06-01-nixos-installation-declarative/\">(declaratively) installed\nNixOS</a> on that VM as described in this blog post:</p>\n\n\n\n  <div class=\"postlink\">\n      <div>\n\t<a href=\"https://michael.stapelberg.ch/posts/2025-06-01-nixos-installation-declarative/\"><h3>How I like to install NixOS (declaratively)</h3></a>\n      </div>\n      <div class=\"summary\">\n\t\n\t\n\t\n\t\n\t\n\t<a href=\"https://michael.stapelberg.ch/posts/2025-06-01-nixos-installation-declarative/\"><img height=\"200\" src=\"https://michael.stapelberg.ch/posts/2025-06-01-nixos-installation-declarative/nix-snowflake-rainbow-featured_hu_2c3edabdd6900fed.png\" width=\"200\" /></a>\n\t\n\t<p>\n\t  <a href=\"https://michael.stapelberg.ch/posts/2025-06-01-nixos-installation-declarative/\">\n\t  For one of my network storage PC builds, I was looking for an alternative to Flatcar Container Linux and tried out NixOS again (after an almost 10 year break). There are many ways to install NixOS, and in this article I will outline how I like to install NixOS on physical hardware or virtual machines: over the network and fully declaratively.\n\n\t  <span class=\"readmore\"><a href=\"https://michael.stapelberg.ch/posts/2025-06-01-nixos-installation-declarative/\">Read more →</a></span>\n\t  </a>\n\t</p>\n      </div>\n  </div>\n\n\n<p>Afterwards, I enabled Immich, with this exact configuration:</p>\n<div class=\"highlight\"><pre tabindex=\"0\"><code class=\"language-nix\"><span style=\"display: flex;\"><span>services<span style=\"color: #666;\">.</span>immich <span style=\"color: #666;\">=</span> {\n</span></span><span style=\"display: flex;\"><span>  enable <span style=\"color: #666;\">=</span> <span style=\"color: #60add5;\">true</span>;\n</span></span><span style=\"display: flex;\"><span>};\n</span></span></code></pre></div><p>At this point, Immich is available on <code>localhost</code>, but not over the network,\nbecause NixOS enables a firewall by default. I could enable the\n<code>services.immich.openFirewall</code> option, but I actually want Immich to only be\navailable via my Tailscale VPN, for which I don’t need to open firewall access —\ninstead, I use <code>tailscale serve</code> to forward traffic to <code>localhost:2283</code>:</p>\n<pre tabindex=\"0\"><code>photos# tailscale serve --bg http://localhost:2283\n</code></pre><p>Because I have <a href=\"https://tailscale.com/kb/1081/magicdns\">Tailscale’s MagicDNS</a>\nand <a href=\"https://tailscale.com/kb/1153/enabling-https\">TLS certificate provisioning</a>\nenabled, that means I can now open <a href=\"https://photos.example.ts.net\">https://photos.example.ts.net</a> in my browser\non my PC, laptop or phone.</p>\n<h2 id=\"step-2-initial-photos-import\">Step 2. Initial photos import</h2>\n<p>At first, I tried importing my photos using the official Immich CLI:</p>\n<pre tabindex=\"0\"><code>% nix run nixpkgs#immich-cli -- login https://photos.example.ts.net secret\n% nix run nixpkgs#immich-cli -- upload --recursive /home/michael/lib/photo/gphotos-takeout\n</code></pre><p>Unfortunately, the upload was not running reliably and had to be restarted\nmanually a few times after running into a timeout. Later I realized that this\nwas because the Immich server runs background jobs like thumbnail creation,\nmetadata extraction or face detection, and these background jobs slow down the\nupload to the extent that the upload can fail with a timeout.</p>\n<p>The other issue was that even after the upload was done, I realized that Google\nTakeout archives for Google Photos contain metadata in separate JSON files next\nto the original image files:</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<a href=\"https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/2025-11-19-google-photos-takeout.jpg\"><img alt=\"Takeout: Google Photos formats\" height=\"720\" src=\"https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/2025-11-19-google-photos-takeout_hu_8ac7b224e95d405d.jpg\" style=\"border: 1px solid #000;\" title=\"Takeout: Google Photos formats\" width=\"600\" /></a>\n\n\n\n<p>Unfortunately, these files are not considered by <code>immich-cli</code>.</p>\n<p>Luckily, there is a great third-party tool called\n<a href=\"https://github.com/simulot/immich-go\">immich-go</a>, which solves both of these\nissues! It pauses background tasks before uploading and restarts them\nafterwards, which works much better, and it does its best to understand Google\nTakeout archives.</p>\n<p>I ran <code>immich-go</code> as follows and it worked beautifully:</p>\n<pre tabindex=\"0\"><code>% immich-go \\\n  upload \\\n  from-google-photos \\\n  --server=https://photos.example.ts.net \\\n  --api-key=secret \\\n  ~/Downloads/takeout-*.zip\n</code></pre><h2 id=\"step-3-install-the-immich-iphone-app\">Step 3. Install the Immich iPhone App</h2>\n<p>My main source of new photos is my phone, so I installed the Immich app on my\niPhone, logged into my Immich server via its Tailscale URL and enabled automatic\nbackup of new photos via the icon at the top right.</p>\n<p>I am not 100% sure whether these settings are correct, but it seems like camera\nphotos generally go into Live Photos, and Recent should cover other files…?!</p>\n<p>If anyone knows, please send an explanation (or a link!) and I will update the article.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<a href=\"https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/IMG_5893.PNG\"><img height=\"1304\" src=\"https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/IMG_5893_hu_8ba00d1bf6088e0a.PNG\" style=\"border: 1px solid #000;\" width=\"600\" /></a>\n\n\n\n<p>I also strongly recommend to disable notifications for Immich, because otherwise\nyou get notifications whenever it uploads images in the background. These\nnotifications are not required for background upload to work, as <a href=\"https://www.reddit.com/r/immich/comments/1nnk8i9/comment/nfoffbb/\">an Immich\ndeveloper confirmed on\nReddit</a>. Open\n<em>Settings</em> → <em>Apps</em> → <em>Immich</em> → <em>Notifications</em> and un-tick the permission checkbox:</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<a href=\"https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/IMG_5894.PNG\"><img height=\"667\" src=\"https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/IMG_5894_hu_3ee31e31d3c5d235.PNG\" style=\"border: 1px solid #000;\" width=\"600\" /></a>\n\n\n\n<h2 id=\"step-4-backup\">Step 4. Backup</h2>\n<p><a href=\"https://docs.immich.app/administration/backup-and-restore\">Immich’s documentation on\nbackups</a> contains\nsome good recommendations. The Immich developers recommend backing up the entire\ncontents of <code>UPLOAD_LOCATION</code>, which is <code>/var/lib/immich</code> on NixOS. The\n<code>backups</code> subdirectory contains SQL dumps, whereas the 3 directories <code>upload</code>,\n<code>library</code> and <code>profile</code> contain all user-uploaded data.</p>\n<p>Hence, I have set up a systemd timer that runs <code>rsync</code> to copy <code>/var/lib/immich</code>\nonto my PC, which is enrolled in a <a href=\"https://www.backblaze.com/blog/the-3-2-1-backup-strategy/\">3-2-1 backup\nscheme</a>.</p>\n<h2 id=\"whats-missing\">What’s missing?</h2>\n<p>Immich (currently?) does not contain photo editing features, so to rotate or\ncrop an image, I download the image and use <a href=\"https://www.gimp.org/\">GIMP</a>.</p>\n<p>To share images, I still upload them to Google Photos (depending on who I share\nthem with).</p>\n<h2 id=\"why-immich-instead-of\">Why Immich instead of…?</h2>\n<p>The two most promising options in the space of self-hosted image management\ntools seem to be <a href=\"https://immich.app/\">Immich</a> and <a href=\"http://ente.io/\">Ente</a>.</p>\n<p>I got the impression that Immich is more popular in my bubble, and Ente made the\nimpression on me that its scope is far larger than what I am looking for:</p>\n<blockquote>\n<p>Ente is a service that provides a fully open source, end-to-end encrypted\nplatform for you to store your data in the cloud without needing to trust the\nservice provider. On top of this platform, we have built two apps so far: Ente\nPhotos (an alternative to Apple and Google Photos) and Ente Auth (a 2FA\nalternative to the deprecated Authy).</p>\n</blockquote>\n<p>I don’t need an end-to-end encrypted platform. I already have encryption on the\ntransit layer (Tailscale) and disk layer (LUKS), no need for more complexity.</p>\n<h2 id=\"conclusion\">Conclusion</h2>\n<p>Immich is a delightful app! It’s very fast and generally seems to work well.</p>\n<p>The initial import is smooth, but only if you use the right tool. Ideally, the\nofficial <code>immich-cli</code> could be improved. Or maybe <code>immich-go</code> could be made the\nofficial one.</p>\n<p>I think the auto backup is too hard to configure on an iPhone, so that could\nalso be improved.</p>\n<p>But aside from these initial stumbling blocks, I have no complaints.</p>",
  "id": "https://michael.stapelberg.ch/posts/2025-11-29-self-hosting-photos-with-immich/"
}